#cloud-config
apt_sources:
 - source: "ppa:chris-lea/node.js"
 - source: "ppa:linaro-maintainers/toolchain"

packages:
 - sed
 - wget
 - subversion
 - git-core
 - coreutils
 - unzip
 - make
 - gcc
 - build-essential
 - g++
 - apache2
 - lzop
 - nodejs
 - nodejs-dev
 - npm
 - software-properties-common
 - gcc-arm-linux-gnueabi 

debconf_selections: |
        debconf debconf/priority select critical
        dash dash/sh boolean false

runcmd:
 - dpkg-reconfigure -f noninteractive dash
 - chown ubuntu /mnt
 - npm install -g connect
 - [ su, -c, "( git clone git://github.com/jadonk/validation-scripts.git /mnt/build )", ubuntu ]
 - [ su, -c, "( cd /mnt/build; nohup ./ec2-build/server.sh 2>&1 >/mnt/build/server.log & )", ubuntu ]
 - [ su, -c, "( cd /mnt/build/ec2-build; nohup ./build-kernel.sh 2>&1 >/mnt/build/build.log & )", ubuntu ]

